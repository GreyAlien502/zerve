#!/usr/bin/env python3 
import smtplib
import random

from catfacts import catfacts
from commands import folder

def sendEmail(gmail_sender,gmail_passwd,TO,SUBJECT,TEXT):
	server = smtplib.SMTP('smtp.gmail.com', 587)
	server.ehlo()
	server.starttls()
	server.ehlo()
	server.login(gmail_sender, gmail_passwd)

	BODY = '\r\n'.join(['To: %s' % TO,
	'From: %s' % gmail_sender,
	'Subject: %s' % SUBJECT,
	'', TEXT])

	try:
		server.sendmail(gmail_sender, [TO], BODY)
		print ('email sent')
	except:
		print ('error sending mail')
	server.quit()

def getClients():
	fil = open(folder()+'cats/'+'clients')
	return fil.read().splitlines()

clients = getClients()
fact = random.choice(catfacts)
[sendemail('greyalien502@gmail.com','goatpotpie0',client,'CAT',fact) for client in clients]
